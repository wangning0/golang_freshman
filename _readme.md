# Go语言实战

## Go语言的介绍

**开发速度**

Go语言使用了更加智能的编译器，简化了解决依赖的算法，提供了更快的编译速度，编译Go时，编译器只会关注那些直接被引用的库，而不是像java、C和C++那样要遍历依赖链中所有依赖的库

**并发**

Go语言对并发的支持是这门语言最重要的特性之一，goroutine就像线程，但是它占用的内存远少于线程，使用它的代码更少，通道（channel)是一种内置的数据结构，可以让用户在不同的goroutine之间同步发送具有类型的消息


## 快速开始一个Go程序

* 在Go语言里，标识符要么从包里公开，要么不从包里公开，当代码导入了一个包时，程序可以直接访问这个包中任意一个公开的标识符。公开的标识符已大写字母开头，不公开的是小写字母开头

* 在Go语言中，所有的变量都会被初始化为其零值

    * 数值类型 零值为0
    * 字符串类型 零值为空字符串
    * 布尔类型 零值为false
    * 指针  零值为nil
    * 引用类型 所引用的底层数据结构会被初始化为对应的零值


## 打包和工具链

### 包

所有Go语言的程序都会组织称若干组文件，每组文件都被称为一个包。这样每个包的代码都可以作为很小的复用但愿，被其他项目引用

所有的.go文件，除了空行和注释意外，都应该在第一行声明自己所属的包，每个包都在一个单独的目录下，不能把多个包放在同一个目录中，也不能把同一个包的文件分拆到多个不同目录中。

**同一个目录下的所有.go文件必须声明同一个包名**

* 包名惯例

给包命名的管理就是使用包所在目录的名字，给包及其目录命名时，应该使用简洁、清晰且全小写的名字

* main包

命名为main的包具有特殊含义，Go语言的编译程序会试图把这种名字的包编译为二进制可执行文件

当编译器发现某个包的名字为main时，它一定会发现名为main的函数，否则不会生成可执行文件

如果把这个包的名字改成非 main 的名字，则编译器会以为这是一个包 而不是命令

```
package hello

import "fmt"

func main() {
    fmt.Println("hello world)
}
```

### 导入

编译器会使用Go环境变量设置的路径，通过引入的相对路径来查找磁盘上的包，标准库的包会在安装Go的位置上找到，Go开发者创建的包会在GOPAT环境变量指定的目录里查找

* 远程导入

`import "github.com/spf13/viper"`

* 命名导入

```
package main
import (
    "fmt"
    myfmt "mylib/fmt"
)
func main() {
    // ...
}
```

当你导入了一个不在代码使用的包，Go编译器会编译失败，并输出一个错误

下划线字符(_) 在Go语言里称为空白标识符，有很多用法，这个标识符用来抛弃了不想继续是痛的值，给导入的包一个空名字，或者忽略函数返回的你不敢兴趣的值

### 函数init

每个包都可以包含任意多个init函数，这些函数都会在程序执行开始的时候被调用，所有被编译器发现的init函数都会被安排在main函数之前执行，init函数用在设置包、初始化变量或者其他要在程序运行之前优先完成的引导工作

数据库驱动为例，database下的驱动灾启动时执行init函数会将自身注册到sql包里，因为sql包在编译时并不知道这些驱动的存在，等启动之后sql才能调用这些驱动

```
package postges 

import (
    "database/sql
)

func init() {
    sql.Register("postges", new(POstgresDriver))
}
```
